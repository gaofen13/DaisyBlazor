@page "/table"
@using DaisyBlazor.Shared.Data
@inject WeatherForecastService ForecastService

<DaisyDataTable Items="@_forecasts"
                MultiSelection ShowPager TotalPager="25"
                PagePosition="PositionX.End"
                PageIndex="@_index"
                PageSzie="@_size"
                PageSizeOption="@(new int[]{5,10,30,100})"
                PageSizeChanged="(size)=>GetWeaterForecastAsync(_index,size)"
                PageIndexChanged="(index)=>GetWeaterForecastAsync(index,_size)">
    <ToolbarTemplate>
        <DaisyButtonGroup>
            <DaisyButton Color="Color.Primary">Add</DaisyButton>
            <DaisyButton Color="Color.Accent">Edit</DaisyButton>
            <DaisyButton Color="Color.Secondary">Delete</DaisyButton>
        </DaisyButtonGroup>
    </ToolbarTemplate>
    <Columns>
        <DaisyColumn Title="Data">@context.Date</DaisyColumn>
        <DaisyColumn Title="TemperatureC">@context.TemperatureC</DaisyColumn>
        <DaisyColumn Title="TemperatureF">@context.TemperatureF</DaisyColumn>
        <DaisyColumn Title="Summary">@context.Summary</DaisyColumn>
    </Columns>
</DaisyDataTable>

@code {
    private int _index = 1;
    private int _size = 5;
    private WeatherForecast[]? _forecasts;

    protected override async Task OnInitializedAsync()
    {
        await GetWeaterForecastAsync(_index, _size);
    }

    private async Task GetWeaterForecastAsync(int index, int size)
    {
        _index = index;
        _size = size;
        _forecasts = await ForecastService.GetForecastAsync(DateTime.Now, _index, _size);
    }
}
